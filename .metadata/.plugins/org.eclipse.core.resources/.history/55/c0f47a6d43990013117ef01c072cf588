/*
 * HiScoreAcivity
 * retrieves the hiscores from the hiScoreServer & shows them
 */

package nl.mprog.evilspacemonsterhangman;

import java.io.BufferedInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;

import nl.mprog.evilspacemonsterhangman.models.HiScore;
import android.app.Activity;
import android.util.JsonReader;

public class HiScoreActivity extends Activity {
	
	public void onCreate() {
		HttpURLConnection urlConnection;
		
		try {
			URL url = new URL("http://localhost/hiscores.json");
			urlConnection = (HttpURLConnection) url.openConnection();
		
		    InputStream in = new BufferedInputStream(urlConnection.getInputStream());
		    readJsonStream(in);
		}catch(Exception e) {
			e.printStackTrace();
		}finally {
			
	    }
	}
		
	public List readJsonStream(InputStream in) throws IOException {
		JsonReader reader = new JsonReader(new InputStreamReader(in, "UTF-8"));
	    try {
	    	return readMessagesArray(reader);
	    }finally {
	    	reader.close();
	    }
	}
	
     public List readMessagesArray(JsonReader reader) throws IOException {
		 List messages = new ArrayList();
		
		 reader.beginArray();
		 while (reader.hasNext()) {
		   messages.add(new HiScore(reader));
		 }
		 reader.endArray();
		 return messages;
   }
}
